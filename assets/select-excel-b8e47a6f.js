import{bu as b,bD as x,_ as D,o as h,c as E,b as t,k as l,d as s,a as m,a3 as S,m as y,z as c,E as L,t as v,a1 as C}from"./index-bac48f2f.js";import{v as T}from"./el-loading-90d8eac8.js";import{E as V,a as k}from"./el-table-column-9195ce7a.js";import{f as B}from"./article-47a106a1.js";import"./_initCloneObject-ca8d68f8.js";const I={name:"SelectExcel",data(){return{list:[],listLoading:!0,multipleSelection:[],downloadLoading:!1,filename:""}},created(){this.fetchData()},methods:{fetchData(){this.listLoading=!0,B().then(a=>{this.list=a.data.items,this.listLoading=!1})},handleSelectionChange(a){this.multipleSelection=a},handleDownload(){this.multipleSelection.length?(this.downloadLoading=!0,b(()=>import("./Export2Excel-1cd61894.js"),["assets/Export2Excel-1cd61894.js","assets/index-bac48f2f.js","assets/index-36cdb363.css"]).then(a=>{const o=["Id","Title","Author","Readings","Date"],d=["id","title","author","pageviews","display_time"],r=this.multipleSelection,n=this.formatJson(d,r);a.export_json_to_excel({header:o,data:n,filename:this.filename}),this.$refs.multipleTable.clearSelection(),this.downloadLoading=!1})):x({message:"Please select at least one item",type:"warning"})},formatJson(a,o){return o.map(d=>a.map(r=>d[r]))}}},P={class:"app-container"},A={href:"https://panjiachen.github.io/vue-element-admin-site/feature/component/excel.html",target:"_blank",style:{"margin-left":"15px"}},N=m("i",{class:"el-icon-time"},null,-1);function R(a,o,d,r,n,u){const p=L,f=v,_=C,i=V,g=k,w=T;return h(),E("div",P,[t(p,{modelValue:n.filename,"onUpdate:modelValue":o[0]||(o[0]=e=>n.filename=e),placeholder:"Please enter the file name (default excel-list)",style:{width:"350px"},"prefix-icon":"Document"},null,8,["modelValue"]),t(f,{loading:n.downloadLoading,style:{"margin-bottom":"20px"},type:"primary",icon:"Document",onClick:u.handleDownload},{default:l(()=>[s(" Export Selected Items ")]),_:1},8,["loading","onClick"]),m("a",A,[t(_,{type:"info"},{default:l(()=>[s("Documentation")]),_:1})]),S((h(),y(g,{ref:"multipleTable",data:n.list,"element-loading-text":"拼命加载中",border:"",fit:"","highlight-current-row":"",onSelectionChange:u.handleSelectionChange},{default:l(()=>[t(i,{type:"selection",align:"center"}),t(i,{align:"center",label:"Id",width:"95"},{default:l(e=>[s(c(e.$index),1)]),_:1}),t(i,{label:"Title"},{default:l(e=>[s(c(e.row.title),1)]),_:1}),t(i,{label:"Author",width:"110",align:"center"},{default:l(e=>[t(_,null,{default:l(()=>[s(c(e.row.author),1)]),_:2},1024)]),_:1}),t(i,{label:"Readings",width:"115",align:"center"},{default:l(e=>[s(c(e.row.pageviews),1)]),_:1}),t(i,{align:"center",label:"PDate",width:"220"},{default:l(e=>[N,m("span",null,c(e.row.display_time),1)]),_:1})]),_:1},8,["data","onSelectionChange"])),[[w,n.listLoading]])])}const M=D(I,[["render",R]]);export{M as default};
