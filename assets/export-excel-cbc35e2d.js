import{f as V,M as y,o as f,c as g,b as o,l as k,q as w,a as _,E as D,k as n,d as m,a5 as O,a6 as L,bs as B,bt as W,bu as A,bv as C,_ as F,B as x,a3 as R,m as U,z as b,t as I,a1 as Y}from"./index-b51a1070.js";import{v as H}from"./el-loading-b716667b.js";import{E as M,a as N}from"./el-table-column-dd0c3da9.js";import{f as P}from"./article-301491fb.js";import{d as j}from"./dayjs.min-d2b2edba.js";import{b as J,a as S}from"./el-radio-group-bcd04af1.js";import"./_initCloneObject-0633ec97.js";const q={style:{display:"inline-block"}},z=_("label",{class:"radio-label",style:{"padding-left":"0"}},"Filename: ",-1),G=V({__name:"FilenameOption",props:{modelValue:{default:""}},emits:["update:modelValue"],setup(i,{emit:l}){const s=i;let t=y({get(){return s.modelValue},set(e){l("update:modelValue",e)}});return(e,d)=>{const u=D;return f(),g("div",q,[z,o(u,{modelValue:k(t),"onUpdate:modelValue":d[0]||(d[0]=r=>w(t)?t.value=r:t=r),placeholder:"Please enter the file name (default excel-list)",style:{width:"345px"},"prefix-icon":"Document"},null,8,["modelValue"])])}}});const K={style:{display:"inline-block"}},Q=_("label",{class:"radio-label"},"Cell Auto-Width: ",-1),X=V({__name:"AutoWidthOption",props:{modelValue:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(i,{emit:l}){const s=i;let t=y({get(){return s.modelValue},set(e){l("update:modelValue",e)}});return(e,d)=>{const u=J,r=S;return f(),g("div",K,[Q,o(r,{modelValue:k(t),"onUpdate:modelValue":d[0]||(d[0]=c=>w(t)?t.value=c:t=c)},{default:n(()=>[o(u,{label:!0,border:""},{default:n(()=>[m(" True ")]),_:1}),o(u,{label:!1,border:""},{default:n(()=>[m(" False ")]),_:1})]),_:1},8,["modelValue"])])}}}),Z={style:{display:"inline-block"}},$=_("label",{class:"radio-label"},"Book Type: ",-1),ee=V({__name:"BookTypeOption",props:{modelValue:{default:"xlsx"}},emits:["update:modelValue"],setup(i,{emit:l}){const s=i,t=["xlsx","csv","txt"];let e=y({get(){return s.modelValue},set(d){l("update:modelValue",d)}});return(d,u)=>{const r=B,c=W;return f(),g("div",Z,[$,o(c,{modelValue:k(e),"onUpdate:modelValue":u[0]||(u[0]=p=>w(e)?e.value=p:e=p),style:{width:"120px"}},{default:n(()=>[(f(),g(O,null,L(t,p=>o(r,{key:p,label:p,value:p},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])}}}),te={name:"ExportExcel",components:{FilenameOption:G,AutoWidthOption:X,BookTypeOption:ee},data(){return{list:[],listLoading:!0,downloadLoading:!1,filename:"",autoWidth:!0,bookType:"xlsx",dayjs:j}},created(){this.fetchData()},methods:{fetchData(){this.listLoading=!0,P().then(i=>{this.list=i.data.items,this.listLoading=!1})},handleDownload(){this.downloadLoading=!0,A(()=>import("./Export2Excel-cb784189.js"),["assets/Export2Excel-cb784189.js","assets/index-b51a1070.js","assets/index-ddc1887b.css"]).then(i=>{const l=["Id","Title","Author","Readings","Date"],s=["id","title","author","pageviews","display_time"],t=this.list,e=this.formatJson(s,t);i.export_json_to_excel({header:l,data:e,filename:this.filename,autoWidth:this.autoWidth,bookType:this.bookType}),this.downloadLoading=!1})},formatJson(i,l){return l.map(s=>i.map(t=>t==="timestamp"?C(s[t]):s[t]))}}};const oe={class:"app-container"},le={href:"https://panjiachen.github.io/vue-element-admin-site/feature/component/excel.html",target:"_blank",style:{"margin-left":"15px"}},ae=_("i",{class:"el-icon-time"},null,-1);function ne(i,l,s,t,e,d){const u=x("FilenameOption"),r=x("AutoWidthOption"),c=x("BookTypeOption"),p=I,v=Y,h=M,E=N,T=H;return f(),g("div",oe,[_("div",null,[o(u,{modelValue:e.filename,"onUpdate:modelValue":l[0]||(l[0]=a=>e.filename=a)},null,8,["modelValue"]),o(r,{modelValue:e.autoWidth,"onUpdate:modelValue":l[1]||(l[1]=a=>e.autoWidth=a)},null,8,["modelValue"]),o(c,{modelValue:e.bookType,"onUpdate:modelValue":l[2]||(l[2]=a=>e.bookType=a)},null,8,["modelValue"]),o(p,{loading:e.downloadLoading,style:{margin:"0 0 20px 20px"},type:"primary",icon:"Document",onClick:d.handleDownload},{default:n(()=>[m(" Export Excel ")]),_:1},8,["loading","onClick"]),_("a",le,[o(v,{type:"info"},{default:n(()=>[m("Documentation")]),_:1})])]),R((f(),U(E,{data:e.list,"element-loading-text":"Loading...",border:"",fit:"","highlight-current-row":""},{default:n(()=>[o(h,{align:"center",label:"Id",width:"95"},{default:n(a=>[m(b(a.$index),1)]),_:1}),o(h,{label:"Title"},{default:n(a=>[m(b(a.row.title),1)]),_:1}),o(h,{label:"Author",width:"110",align:"center"},{default:n(a=>[o(v,null,{default:n(()=>[m(b(a.row.author),1)]),_:2},1024)]),_:1}),o(h,{label:"Readings",width:"115",align:"center"},{default:n(a=>[m(b(a.row.pageviews),1)]),_:1}),o(h,{align:"center",label:"Date",width:"220"},{default:n(a=>[ae,_("span",null,b(e.dayjs(a.row.timestamp).format("YYYY-MM-DD HH:mm")),1)]),_:1})]),_:1},8,["data"])),[[T,e.listLoading]])])}const _e=F(te,[["render",ne]]);export{_e as default};
