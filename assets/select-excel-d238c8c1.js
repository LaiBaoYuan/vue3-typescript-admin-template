import{bv as b,bC as x,_ as E,o as p,c as D,b as t,k as l,d as s,a as m,a2 as S,m as v,z as r,E as y,t as L}from"./index-089552d5.js";import{v as C}from"./el-loading-1f1e9716.js";import{E as T,a as V}from"./el-table-column-01d8c4a3.js";/* empty css               */import{f as k}from"./article-e54883fa.js";import{E as B}from"./index-2ce242db.js";import"./_initCloneObject-a315db8e.js";const I={name:"SelectExcel",data(){return{list:[],listLoading:!0,multipleSelection:[],downloadLoading:!1,filename:""}},created(){this.fetchData()},methods:{fetchData(){this.listLoading=!0,k().then(a=>{this.list=a.data.items,this.listLoading=!1})},handleSelectionChange(a){this.multipleSelection=a},handleDownload(){this.multipleSelection.length?(this.downloadLoading=!0,b(()=>import("./Export2Excel-e0bce812.js"),["assets/Export2Excel-e0bce812.js","assets/index-089552d5.js","assets/index-362647f2.css"]).then(a=>{const o=["Id","Title","Author","Readings","Date"],c=["id","title","author","pageviews","display_time"],d=this.multipleSelection,n=this.formatJson(c,d);a.export_json_to_excel({header:o,data:n,filename:this.filename}),this.$refs.multipleTable.clearSelection(),this.downloadLoading=!1})):x({message:"Please select at least one item",type:"warning"})},formatJson(a,o){return o.map(c=>a.map(d=>c[d]))}}},P={class:"app-container"},A={href:"https://panjiachen.github.io/vue-element-admin-site/feature/component/excel.html",target:"_blank",style:{"margin-left":"15px"}},N=m("i",{class:"el-icon-time"},null,-1);function R(a,o,c,d,n,u){const h=y,f=L,_=B,i=T,g=V,w=C;return p(),D("div",P,[t(h,{modelValue:n.filename,"onUpdate:modelValue":o[0]||(o[0]=e=>n.filename=e),placeholder:"Please enter the file name (default excel-list)",style:{width:"350px"},"prefix-icon":"Document"},null,8,["modelValue"]),t(f,{loading:n.downloadLoading,style:{"margin-bottom":"20px"},type:"primary",icon:"Document",onClick:u.handleDownload},{default:l(()=>[s(" Export Selected Items ")]),_:1},8,["loading","onClick"]),m("a",A,[t(_,{type:"info"},{default:l(()=>[s("Documentation")]),_:1})]),S((p(),v(g,{ref:"multipleTable",data:n.list,"element-loading-text":"拼命加载中",border:"",fit:"","highlight-current-row":"",onSelectionChange:u.handleSelectionChange},{default:l(()=>[t(i,{type:"selection",align:"center"}),t(i,{align:"center",label:"Id",width:"95"},{default:l(e=>[s(r(e.$index),1)]),_:1}),t(i,{label:"Title"},{default:l(e=>[s(r(e.row.title),1)]),_:1}),t(i,{label:"Author",width:"110",align:"center"},{default:l(e=>[t(_,null,{default:l(()=>[s(r(e.row.author),1)]),_:2},1024)]),_:1}),t(i,{label:"Readings",width:"115",align:"center"},{default:l(e=>[s(r(e.row.pageviews),1)]),_:1}),t(i,{align:"center",label:"PDate",width:"220"},{default:l(e=>[N,m("span",null,r(e.row.display_time),1)]),_:1})]),_:1},8,["data","onSelectionChange"])),[[w,n.listLoading]])])}const U=E(I,[["render",R]]);export{U as default};
